<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>***SLIDE***</title>
  <style>
    :root{--game-width:100%;--game-height:500px}
    body{margin:0;display:flex;align-items:center;justify-content:center;height:100vh;background:#111;font-family:Inter,system-ui,Arial;color:#fff}
    .game-wrap{width:800px;max-width:96vw;height:var(--game-height);position:relative;overflow:hidden;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.7)}
    .bg{position:absolute;inset:0;background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?fit=crop&w=1600&q=80');background-size:cover;background-repeat:repeat-x;transform:translateZ(0)}

    /* ‚≠ê BOOST GLOW ADDED HERE ‚≠ê */
    .player{position:absolute;left:120px;width:48px;height:72px;font-size:40px;display:flex;align-items:center;justify-content:center;pointer-events:none;text-shadow:0 2px 8px rgba(0,0,0,.6);z-index:30;transition:transform .08s linear}
    .player.boostGlow{
      filter: drop-shadow(0 0 14px gold) drop-shadow(0 0 28px orange);
      transition: filter .12s linear;
    }

    .ring{position:absolute;width:84px;height:84px;border-radius:50%;box-sizing:border-box;pointer-events:none;display:flex;align-items:center;justify-content:center;z-index:10}
    .ring.visual{border:6px solid rgba(255,215,0,.95);filter:drop-shadow(0 8px 18px rgba(255,200,60,.15));transform:rotateX(80deg);}
    .fruit{position:absolute;font-size:32px;animation:float 2s ease-in-out infinite alternate;z-index:12}
    @keyframes float{from{transform:translateY(-5px)}to{transform:translateY(5px)}}
    .hud{position:absolute;left:12px;top:12px;z-index:50}
    .title{font-weight:800;font-style:italic;font-size:20px;letter-spacing:.5px}
    .score{margin-top:6px;font-size:16px}
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);flex-direction:column;z-index:120}
    .btn{margin-top:14px;padding:10px 16px;border-radius:8px;border:0;background:#1f8f3d;color:white;font-weight:700;cursor:pointer}
    .turbo{position:absolute;font-size:36px;z-index:28;pointer-events:none;filter:drop-shadow(0 8px 18px rgba(0,0,0,.5))}
    .fly{position:absolute;font-size:28px;z-index:28;pointer-events:none}
    .rocket{position:absolute;font-size:18px;z-index:26}
    .missPopup{position:absolute;left:50%;transform:translateX(-50%);top:28px;background:rgba(255,80,80,0.9);padding:8px 12px;border-radius:8px;font-weight:800;z-index:200;opacity:0;transition:opacity .3s}
    .immunityBarWrap{position:absolute;left:190px;top:18px;width:140px;height:10px;border-radius:8px;background:rgba(255,255,255,0.12);overflow:hidden;z-index:60;display:none}
    .immunityBar{height:100%;width:100%;background:linear-gradient(90deg,#8be3ff,#4be29f);transform-origin:left;transition:width .1s}
    .explosion{position:absolute;width:100px;height:100px;border-radius:50%;pointer-events:none;z-index:40;mix-blend-mode:screen}
    .final-row{display:flex;gap:12px;align-items:center}
  </style>
</head>
<body>
  <div class="game-wrap" id="game">
    <div class="bg" id="bg"></div>
    <div class="player" id="player">üç∏</div>

    <div class="hud">
      <div class="title"><strong><em>SLIDE</em></strong></div>
      <div class="score">Score: <span id="score">0</span></div>
    </div>

    <div id="rings"></div>
    <div id="fruits"></div>

    <div id="turboWrap"></div>
    <div id="flyWrap"></div>
    <div id="rocketWrap"></div>

    <div id="missPopup" class="missPopup"></div>
    <div class="immunityBarWrap" id="immunityWrap"><div class="immunityBar" id="immunityBar"></div></div>

    <div id="overlay" class="overlay" style="display:none">
      <div id="overlayText" style="font-size:28px;font-weight:800"></div>
      <div id="finalDetails" style="margin-top:12px"></div>
      <button id="restart" class="btn">Restart</button>
    </div>

    <audio id="jumpSfx" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>
    <audio id="shatterSfx" src="https://actions.google.com/sounds/v1/impacts/glass_breaking.ogg" preload="auto"></audio>
    <audio id="winSfx" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
    <audio id="explosionSfx" src="https://actions.google.com/sounds/v1/impacts/explosion.ogg" preload="auto"></audio>
    <audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2023/02/28/audio_91b56b86db.mp3?filename=chill-ambient-14013.mp3" loop preload="auto"></audio>
  </div>

<script>
(function(){
  const PLAYER_X = 120;
  const GAME_HEIGHT = 500;
  const GRAVITY = 0.6;
  const JUMP_FORCE = -10;
  const RING_COUNT = 100;
  const RING_SPACING = 300;
  const FRUITS = ["üçé","üçå","üçá","üçä","üçâ","üçì","üçç","ü•ù","üçí","üçê"];
  const FRUIT_POINTS = [5,10,15,20,25,30,35,40,50,100];

  const baseSpeed = 2;
  const turboImmuneSeconds = 7;
  const turboSchedule = [30*1000,15*1000,50*1000];
  const turboRandomMin = 20*1000, turboRandomMax = 40*1000;

  const flySpeedMultiplier = 0.5;
  const flyChangeDirMs = 1300;

  /* ‚≠ê CHANGED: ROCKET NOW EVERY 5 SECONDS ‚≠ê */
  const rocketSpawnInterval = 5000;

  let playerY = 200;
  let velocity = 0;
  let rings = [];
  let fruits = [];
  let score = 0;
  let gameOver = false;
  let bgX = 0;

  let missedRings = 0;
  const MISS_LIMIT = 5;
  let processedRings = 0;

  let turbo = null;
  let turboTimers = [];
  let immune = false;
  let immuneRemaining = 0;
  let immunityTimerId = null;

  let fly = null;
  let activeRockets = [];
  let rocketIntervalId = null;
  let rocketSpeedMultiplier = 1;

  const gameEl = document.getElementById('game');
  const playerEl = document.getElementById('player');
  const ringsEl = document.getElementById('rings');
  const fruitsEl = document.getElementById('fruits');
  const scoreEl = document.getElementById('score');
  const overlay = document.getElementById('overlay');
  const overlayText = document.getElementById('overlayText');
  const finalDetails = document.getElementById('finalDetails');
  const restartBtn = document.getElementById('restart');
  const bgEl = document.getElementById('bg');
  const jumpSfx = document.getElementById('jumpSfx');
  const shatterSfx = document.getElementById('shatterSfx');
  const explosionSfx = document.getElementById('explosionSfx');
  const bgMusic = document.getElementById('bgMusic');
  const turboWrap = document.getElementById('turboWrap');
  const flyWrap = document.getElementById('flyWrap');
  const rocketWrap = document.getElementById('rocketWrap');
  const missPopup = document.getElementById('missPopup');
  const immunityWrap = document.getElementById('immunityWrap');
  const immunityBar = document.getElementById('immunityBar');

  function spawnRings(){
    rings = [];
    ringsEl.innerHTML = '';
    for(let i=0;i<RING_COUNT;i++){
      const x = 800 + i * RING_SPACING;
      const y = 80 + Math.random()*(GAME_HEIGHT - 160);
      const ring = {x,y,passed:false,processed:false,el:null};
      rings.push(ring);
      const el = document.createElement('div');
      el.className = 'ring visual';
      el.style.left = x+'px';
      el.style.top = y+'px';
      ringsEl.appendChild(el);
      ring.el = el;
    }
  }

  function spawnFruits(){
    fruits = [];
    fruitsEl.innerHTML = '';
    for(let i=0;i<FRUITS.length;i++){
      const x = 600 + Math.random()*2000;
      const y = 50 + Math.random()*(GAME_HEIGHT-100);
      const fruit = {x,y,emoji:FRUITS[i],points:FRUIT_POINTS[i],collected:false,el:null};
      fruits.push(fruit);
      const el = document.createElement('div');
      el.className = 'fruit';
      el.textContent = fruit.emoji;
      el.style.left = x+'px';
      el.style.top = y+'px';
      fruitsEl.appendChild(el);
      fruit.el = el;
    }
  }

  function scheduleTurboEvents(){
    turboTimers.forEach(t => clearTimeout(t));
    turboTimers = [];
    let cumulative = 0;
    for(let i=0;i<turboSchedule.length;i++){
      cumulative += turboSchedule[i];
      const t = setTimeout(()=>{ spawnTurbo(); if(i===turboSchedule.length-1) scheduleRandomTurbo(); }, cumulative);
      turboTimers.push(t);
    }
  }

  function scheduleRandomTurbo(){
    const scheduleNext = ()=>{
      const nextMs = turboRandomMin + Math.random()*(turboRandomMax-turboRandomMin);
      const t = setTimeout(()=>{
        spawnTurbo();
        scheduleNext();
      }, nextMs);
      turboTimers.push(t);
    };
    scheduleNext();
  }

  function spawnTurbo(){
    if(gameOver || turbo) return;
    const startX = 900;
    const startY = 40 + Math.random()*(GAME_HEIGHT-80);
    const el = document.createElement('div');
    el.className = 'turbo';
    el.textContent = 'üå©';
    el.style.left = startX+'px';
    el.style.top = startY+'px';
    turboWrap.appendChild(el);

    const duration = 2500;
    const startTime = performance.now();
    const endX = -80;
    const deltaX = endX - startX;
    const amplitude = Math.min((GAME_HEIGHT - 120)/2, 120);
    const centerY = GAME_HEIGHT/2;

    turbo = {el,startX,startY,startTime,duration,deltaX,amplitude,centerY};
  }

  function updateTurbo(){
    if(!turbo) return;
    const now = performance.now();
    const t = (now - turbo.startTime)/turbo.duration;
    if(t >= 1){
      turbo.el.remove();
      turbo = null;
      return;
    }
    const x = turbo.startX + turbo.deltaX * t;
    const cycles = 3;
    const y = turbo.centerY + turbo.amplitude * Math.sin(t * cycles * Math.PI * 2);

    turbo.el.style.left = x+'px';
    turbo.el.style.top = y+'px';

    const dx = (PLAYER_X+24)-(x+18);
    const dy = (playerY+36)-(y+18);
    if(Math.sqrt(dx*dx+dy*dy)<36){
      consumeTurbo();
      turbo.el.remove();
      turbo=null;
    }
  }

  function consumeTurbo(){
    missedRings = Math.max(0, missedRings-1);
    showMissPopup("-1 MISSED RINGS");

    immune = true;
    immuneRemaining = turboImmuneSeconds;
    immunityWrap.style.display="block";

    /* ‚≠ê ADD BOOST GLOW ‚≠ê */
    playerEl.classList.add("boostGlow");

    updateImmunityBar();
    if(immunityTimerId) clearInterval(immunityTimerId);
    immunityTimerId = setInterval(()=>{
      immuneRemaining -= 0.1;
      if(immuneRemaining <= 0){
        clearInterval(immunityTimerId);
        immunityTimerId = null;
        immune = false;
        immunityWrap.style.display="none";
        immunityBar.style.width="100%";

        /* ‚≠ê REMOVE BOOST GLOW ‚≠ê */
        playerEl.classList.remove("boostGlow");
      } else {
        updateImmunityBar();
      }
    },100);
  }

  function updateImmunityBar(){
    const pct = Math.max(0, Math.min(1, immuneRemaining/turboImmuneSeconds));
    immunityBar.style.width = (pct*100)+"%";
  }

  function currentSpeedMultiplier(){ return immune ? 3 : 1; }

  function update(){
    if(gameOver) return;

    velocity += GRAVITY;
    playerY += velocity;

    if(playerY > GAME_HEIGHT-80){
      playerY = GAME_HEIGHT-80;
      if(!immune){ endGame("üíî Glass Shattered! üíî"); return; }
      velocity = Math.min(velocity,2);
    }
    if(playerY < 0){
      playerY = 0;
      velocity = Math.max(velocity,0);
    }

    const mult = currentSpeedMultiplier();

    bgX -= baseSpeed * mult;
    bgEl.style.backgroundPosition = bgX + "px 0";

    if(immune){
      const nudge = Math.min(12,(mult-1)*6);
      const bob = Math.sin(performance.now()/150)*2;
      playerEl.style.transform = `translateX(${nudge}px) translateY(${bob}px) scale(1.02)`;
    } else {
      playerEl.style.transform = "";
    }

    for(let r of rings){
      r.x -= baseSpeed * mult;
      r.el.style.left = r.x+"px";

      if(!r.processed){
        const dx = (PLAYER_X+24)-(r.x+42);
        const dy = (playerY+36)-(r.y+42);
        const dist = Math.sqrt(dx*dx+dy*dy);

        if(!r.passed && Math.abs(r.x-PLAYER_X)<60 && dist<36){
          r.passed=true;
          r.processed=true;
          r.el.style.opacity=0.25;
          score++; processedRings++;
          scoreEl.textContent = score;
          checkRocketSpeed();
          checkAllRingsProcessed();
        }

        if(!r.processed && (r.x+84)<60){
          r.processed=true;
          processedRings++;
          if(!immune){
            missedRings++;
            showMissPopup(missedRings+" MISSED");
            if(missedRings>=MISS_LIMIT){
              endGame("GAME OVER ‚Äî Too Many Misses");
              return;
            }
          } else {
            showMissPopup("IMMUNE ‚Äî MISS IGNORED");
          }
          checkAllRingsProcessed();
        }
      }
    }

    for(let f of fruits){
      if(f.collected) continue;
      f.x -= baseSpeed * mult;

      if(immune){
        const pull=0.06;
        f.x += (PLAYER_X-f.x)*pull;
        f.y += (playerY-f.y)*pull;
      }

      if(f.el){
        f.el.style.left = f.x+"px";
        f.el.style.top = f.y+"px";
      }

      const dx = (PLAYER_X+24)-(f.x+16);
      const dy = (playerY+36)-(f.y+16);
      if(Math.sqrt(dx*dx+dy*dy)<40){
        f.collected=true;
        f.el.style.display="none";
        score+=f.points;
        scoreEl.textContent = score;
      }
    }

    updateTurbo();
    updateFly();
    updateRockets();

    if(!fly && Math.random()<0.002) spawnFly();

    playerEl.style.top = playerY+"px";
    requestAnimationFrame(update);
  }

  function spawnFly(){
    if(gameOver || fly) return;
    const x=900;
    const y=40+Math.random()*(GAME_HEIGHT-80);
    const el=document.createElement('div');
    el.className='fly'; el.textContent='ü™∞';
    el.style.left=x+'px'; el.style.top=y+'px';
    flyWrap.appendChild(el);
    fly={x,y,el,speed:baseSpeed*flySpeedMultiplier,vy:0,lastDir:performance.now()};
  }

  function updateFly(){
    if(!fly) return;
    const now=performance.now();
    if(now-fly.lastDir>flyChangeDirMs){
      fly.lastDir=now;
      const target=playerY+(Math.random()-0.5)*40;
      fly.vy=(target-fly.y)*0.06;
    }
    fly.y+=fly.vy + Math.sin(now/300)*0.45;
    fly.x-=fly.speed*currentSpeedMultiplier();
    fly.el.style.left=fly.x+'px';
    fly.el.style.top=fly.y+'px';

    const dx=(PLAYER_X+24)-(fly.x+12);
    const dy=(playerY+36)-(fly.y+12);
    if(Math.sqrt(dx*dx+dy*dy)<30){
      if(!immune){ endGame("üí• Caught by a Fly! üí•"); return;}
      fly.el.remove(); fly=null;
    }
    if(fly && fly.x<-80){ fly.el.remove(); fly=null; }
  }

  function spawnRocketAt(x,y,speed){
    const el=document.createElement('div');
    el.className='rocket';
    el.textContent='üöÄ';
    el.style.left=x+'px';
    el.style.top=y+'px';
    rocketWrap.appendChild(el);
    activeRockets.push({el,x,y,vx:-speed,vy:0});
  }

  function spawnRocket(){
    if(gameOver) return;
    const x=900;
    const y=40+Math.random()*(GAME_HEIGHT-80);
    const base=6+Math.random()*3;
    spawnRocketAt(x,y, base*rocketSpeedMultiplier);
  }

  function updateRockets(){
    for(let i=activeRockets.length-1;i>=0;i--){
      const r=activeRockets[i];
      const targetY = playerY+36;
      r.vy += (targetY-r.y)*0.04;
      r.vy = Math.max(-8, Math.min(8, r.vy));
      r.x += r.vx;
      r.y += r.vy;

      r.el.style.left=r.x+"px";
      r.el.style.top=r.y+"px";

      const dx=(PLAYER_X+24)-(r.x+12);
      const dy=(playerY+36)-(r.y+12);
      if(Math.sqrt(dx*dx+dy*dy)<36){
        r.el.remove();
        activeRockets.splice(i,1);
        if(!immune){
          explosionAt(r.x,r.y);
          endGame("üî• Hit by a Rocket! üî•");
          return;
        }
        continue;
      }

      if(r.x<-120 || r.y<-120 || r.y>GAME_HEIGHT+120){
        r.el.remove();
        activeRockets.splice(i,1);
      }
    }
  }

  function explosionAt(x,y){
    const el=document.createElement('div');
    el.className='explosion';
    el.style.left=(x-40)+'px';
    el.style.top=(y-40)+'px';
    el.style.background='radial-gradient(circle at 30% 30%, rgba(255,200,60,.9), rgba(255,40,0,.8) 40%, rgba(0,0,0,0) 70%)';
    gameEl.appendChild(el);
    explosionSfx.currentTime=0; explosionSfx.play().catch(()=>{});
    setTimeout(()=>el.remove(),800);
  }

  function showMissPopup(t){
    missPopup.textContent=t;
    missPopup.style.opacity=1;
    setTimeout(()=>missPopup.style.opacity=0,1200);
  }

  function checkRocketSpeed(){
    if(processedRings>=20 && processedRings<40) rocketSpeedMultiplier=1.5;
    if(processedRings>=40) rocketSpeedMultiplier=1.8;
  }

  function checkAllRingsProcessed(){
    if(processedRings>=RING_COUNT) finalizeScore();
  }

  function finalizeScore(){
    if(gameOver) return;
    gameOver=true;
    bgMusic.pause();
    const finalScore = score*100;
    const sample=[42000,36000,28000,22000,18000,14000,12000,8000,6000,3000];
    const all=sample.concat([finalScore]).sort((a,b)=>b-a);
    const rank=all.indexOf(finalScore)+1;
    overlayText.textContent="üèÅ FINISHED";
    finalDetails.innerHTML=`<div class="final-row"><div style="font-size:20px;font-weight:800">Final Score:</div><div style="font-size:20px;margin-left:8px">${finalScore.toLocaleString()}</div></div>
    <div style="margin-top:8px;font-size:16px">Leaderboard Rank: <strong>#${rank}</strong></div>`;
    overlay.style.display="flex";
  }

  function endGame(t){
    if(gameOver) return;
    gameOver=true;
    shatterSfx.currentTime=0; shatterSfx.play().catch(()=>{});
    bgMusic.pause();
    overlayText.textContent=t;
    finalDetails.innerHTML="";
    overlay.style.display="flex";
  }

  function jump(){
    if(gameOver) return;
    velocity = JUMP_FORCE;
    jumpSfx.currentTime=0; jumpSfx.play().catch(()=>{});
  }

  gameEl.addEventListener('click',()=>{
    if(bgMusic.paused){ bgMusic.volume=0.3; bgMusic.play().catch(()=>{}); }
    jump();
  });

  window.addEventListener('keydown',e=>{
    if(e.code==='Space'){
      if(bgMusic.paused){ bgMusic.play().catch(()=>{}); }
      jump();
      e.preventDefault();
    }
  });

  restartBtn.addEventListener('click',()=>location.reload());

  spawnRings();
  spawnFruits();
  playerEl.style.top = playerY+"px";
  requestAnimationFrame(update);
  scheduleTurboEvents();

  rocketIntervalId = setInterval(spawnRocket, rocketSpawnInterval);

})();
</script>
</body>
</html>
